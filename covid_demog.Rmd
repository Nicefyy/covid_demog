---
title: "Monitoring trends and differences in COVID-19 case fatality rates using decomposition methods: A demographic perspective"
author: "Christian Dudel, Tim Riffe, Enrique Acosta, Mikko Myrskyl√§"
date: "25-March-2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Summary

COVID-19 has been spreading rapidly across the world. The case fatality rates (CFRs) associated with COVID-19 outbreaks in different countries have, however, varied significantly. Moreover, the CFR of a country can change considerably over time as the disease spreads. What is driving differences in the CFR between countries and changes over time is currently not well understood. 

We use demographic decomposition methods to disentangle two potential drivers of differences and trends: (1) the age structure of cases and (2) age-specific case fatality rates. We provide numerous applications of this approach, covering Italy, Germany, South Korea, Spain, and Belgium. We show, among other things, that clsoe to 50 percent of the difference between the CFR in Germany and in Italy can be explained with differences in the age structure of cases -- infected individuals in Italy tend to be older. Moreover, we show that increases in the Italian CFR over time are solely due to increasing age-specific CFRs and thus worsening health outcomes of those infected with COVID-19 as health care provision started to fail.   

# 1 Introduction

The novel severe acute respiratory syndrome coronavirus 2 (SARS-CoV-2), or Coronavirus disease 2019 (COVID-19) for short, has been spreading rapidly across the world, and on March 11 2020 was recognised as a pandemic by the World Health Organization.  

COVID-19 outbreaks went along with mostly regular patterns of logarithmic increase of case counts, with a few notable execptions. The number of deaths associated with COVID-19, however, have evolved considerably less regularly. 

For instance, as of March 24 2020, Germany had a total of around 27 thousand confirmed infections and 114 deaths, resulting in a case fatality rate (CFR) of around 0.4 percent [reference]. Italy, on the other hand, up to the same day, had close to 64 thousand cases of infection, around 6 thousand deaths, and a CFR of 9.5 percent. On March 16, Italy had roughly the same number of cases as Germany on March 24, and a CFR of 7.7 percent. Thus, the outbreak in Italy is going along with a much higher CFR, and Italys CFR increased over time. 

What is driving differences and trends in the CFR is currently not well understood. On the one hand, a higher CFR could mean that the risk of dying of COVID-19 differs between countries or changes over time. On the other hand, it could also imply a less favorable composition of the infected population. Specifically, the risk of dying of COVID-19 is well-documented to increase with age. Thus, if the population of infected individuals is older in one case than in another, then the CFR will be higher, even if the age-specific risk of dying is the same. 

Indeed, demographers have argued that age structure matters [1,2]. So far, however,  there have been no assessments of the impact of the age structure of cases of infections, and the literature only provided qualitative assessments of the age structure of different populations to judge the potential severity of COVID-19 outbreaks.

In this paper, we use a demographic decomposition technique to disentangle two potential drivers of differences and trends: (1) the age structure of infection cases and (2) age-specific CFRs. The approach allows to specifically quantify what proportion of a difference between two CFRs can be attributed to age structure and what proportion can be attributed to age-specific CFRs. All data that is required are case counts and death counts by age groups. 

We provide numerous applications of this approach, covering data from Italy, Germany, South Korea, Spain, and Belgium. Our findings show, among other things, that differences between countries with low CFRs (Germany, South Korea) and countries with high CFRs (Italy, Spain) are driven up to 50% by differences in the age structure of cases.

To facilitate the application of the approach described in this paper, we provide code and reproducibility materials for the open source statistical software R.

# 2 Methods

## 2.1 Case fatality rates

The COVID-19 case fatality rate (CFR) is defined as the ratio of deaths associated with COVID-19 divided by the number of detected COVID-19 cases. Formally, if we denote with $D$ the total number of deaths associated with COVID-19 and with $N$ the total number of cases, then $$\textrm{CFR}=\frac{D}{C}.$$ 

If case counts and death counts are available by age, the CFR can also be written as a sum of age-specific CFRs weighted by the proportion of cases in a certain age group. We use $a$ as an index to denote different age groups, and we define age-specific CFRs as $C_a=D_a/N_a$; i.e., the number of deaths in age group $a$ divided by the number of cases in the same age group. The proportion of cases in age group $a$ is given by $P_a=N_a/N$. Using this notation, the CFR can be written as a weighted average of age-specific CFRs: $$\textrm{CFR}=\sum P_a C_a.$$ 
This expression will be used in the decomposition approach described below.

## 2.2 Decomposing CFRs

We want to decompose, or "explain", the difference between two CFRs, irrespective of whether they are for two different countries, or for the same country at two different points in time, or for different groups within a country, e.g., socio-economic groups. We will use $\textrm{CFR}_i$ and $\textrm{CFR}_j$ to distinguish the two CFRs, e.g., country $i$ and country $j$. Moreover, we write $P_{ia}$, $C_{ia}$, $P_{ja}$, and $C_{ja}$ for the underlying age compositions and age-specific CFRs; i.e., $\textrm{CFR}_i=\sum P_{ia} C_{ia}$.   

Using a decomposition approach introduced by Kitagawa [3] we separate the difference between to CFRs into two distinct parts, $$\textrm{CFR}_i-\textrm{CFR}_j=\alpha + \delta,$$ where $\alpha$ captures the part of the difference between CFRs which is due to differences in the age composition of cases, and $\delta$ is due to differences in mortality. $\alpha$ is given by $$\alpha=0.5 \left(\textrm{CFR}_i-\sum P_{ja} C_{ia}+\sum P_{ia} C_{ja}-\textrm{CFR}_j \right),$$ while $\delta$ can be calculated as $$\delta=0.5 \left(\textrm{CFR}_i-\sum P_{ia} C_{ja}+\sum P_{ja} C_{ia}-\textrm{CFR}_j \right).$$ Note that the age groups for group $i$ and group $j$ need to be the same. If this is not the case in the raw data and, for instance, one country reports counts in 5-year age groups (0-4, 5-9, 10-14, 15-19, ...) and the other uses 10-year age groups (0-9, 10-19, ...), then the more finely grained data needs to be aggregated to match the coarser data.

The intuition behind the formulas is as follows. The first two terms in brackets in the equation for $\alpha$ are $\textrm{CFR}_i-\sum P_{ja} C_{ia}$, or, replacing $\textrm{CFR}_i$ with its definition, $\sum P_{ia} C_{ia}-\sum P_{ja} C_{ia}$. The second sum in this expression captures how high the CFR would have been if group $i$ had the same age distribution of infections as group $j$. The difference to the actual CFR (the whole expression) then captures to what extent the CFR is higher than this hypothetical CFR because of the actually observed age distribution of cases. The third and the fourth term in brackets in the equation for $\alpha$ are following a similar logic, but using a different hypothetical comparison, asking how much the CFR of group $j$ would differ it if had the age distribution of age $j$. The formula for $\delta$ again follows a similar logic, but now replacing the age-specific CFRs instead of the age distribution.

To calculate the proportion $\alpha$ and $\delta$ contribute to the total difference one can use $\frac{|\alpha|}{|\alpha|+|\delta|}$ in case of $\alpha$ and $\frac{|\delta|}{|\alpha|+|\delta|}$ for the contribution of $\delta$.  

## 2.3 Interpretation

As an artificial example, assume that the CFR in country A is equal to 2 percent, while it equals 4 percent in country B. Subtracting the CFR of country A from country B gives a difference of 2 percentage points. If a large part of this difference would be due to the age structure, then $\alpha$ could be $0.015$ and $\delta$ could be $0.005$, together being equal to $0.02$ or 2 percentage points. If, as another example, two countries have the same age structure of cases, then $\alpha$ will be zero. Similar holds for $\delta$ if age-specific CFRs are the same for both countries under conisderation. In relative terms, the $\alpha$-component explains 75 percent of the difference between countries, while the $\delta$-component only explains 25 percent.

Note that the total difference between two CFRs as well as both $\alpha$ and $\delta$ can be negative. The formulas for the relative contributions take this into account by using absolute values. If the total difference is positive and either $\alpha$ or $\delta$ are negative, it means that the corresponding part of the difference actually reduces the difference between CFRs. For instance, when comparing the CFR for one country at two points in time, the total difference could be $0.03$; i.e., the CFR increased by three percentage points. If in this case $\alpha$ would be negative, say $-0.01$, it would mean that the age distribution of cases over time got more similar. $\delta$ would be $0.04$ in this scenario, and without changes in the age distribution of infections as captured through $\alpha$, the difference between CFRs would even have increased by four percentage points.

# 3 Data

We use data for the following countries:

* Germany, cumulative infections and deaths as of March 23 2020
* Italy, cumulative data as of March 16 2020 and March 19
* Spain, cumulative data as of March 22
* South Korea, cumulative data up to March 17

All data is reported by the respective health authorities, except for the death data for Germany, which is based on press reports of age at death collected on Wikipedia. For a few cases this data does not report age. For these cases it is imputed as being 80 or older.

The data is provided using different age groups. The following age groups are used in the original data for both case counts and death counts:

* Germany: 0-4, 5-14, 15-34, 35-59, 60-79, 80+  
* Italy: 0-9, 10-19, 20-29, 30-39, 40-49, 50-59, 69-69, 70-79, 80-89, 90+
* Spain: 0-9, 10-19, 20-29, 30-39, 40-49, 50-59, 69-69, 70-79, 80+
* South Korea: 0-9, 10-19, 20-29, 30-39, 40-49, 50-59, 69-69, 70-79, 80+

For the decomposition, the age groups have to match. This means that for some country comparisons age groups have to be aggregated. For instance, when comparing Germany with Italy, the data of both countries has to be aggregated to three age groups: below 60, 60-79, 80 and older. In contrast, this is not necessary when comparing Spain and South Korea, and to a much lesser extent when comparing Italy with the latter two, as in that case only for Italy the two age categories 80-89 and 90+ have to be combined.

# 4 Results

Results can be output using the provided R code. Some examples are provided here.

* Germany vs Italy (March 19): The CFR for Germany is $0.4$ percent, while the CFR of Italy was around $8.6$ percent. The difference is thus around $8.2$ percentage points ($0.082$). $\alpha$ equals $0.037$ and $\delta$ amounts to $0.044$. Thus, the age component explains roughly 46% of the difference, while the mortality component explains 54% percent.
* Italy (March 16) vs Italy (March 19): From March 16 2020 to March 19 the CFR in Italy increased by $1.8$ percentage points from $6.8$ percent to $8.6$ percent. $\alpha$ is about $-0.001$ and thus actually reducing the difference, albeit only to a small extent, while $\delta$ equals $0.019$. This means that around 92% of the change over time can be attributed to (increasing) mortality, while the age structure of cases only had a small effect but became more favorable.

# 5 Discussion

Decomposing differences in case fatality rates over time or between countries reveals crucial insights for monitoring the spread of COVID-19. Our results, for instance, show that differences between countries with low and high CFRs can be driven to a significant extent by the age structure of cases. 

There are potential limitations to the approach discussed here. Most importantly, case counts as well as death counts depend on the testing regime, and both types of counts may be affected by other issues like reporting delays [4]. This means that, for instance, if our approach indicates that a large part of a difference is due to the age structure, this might actually only reflect differences in testing. To assess to what extent this is the case requires expertise about the contexts which are being compared. Results will be, however, correct in the sense that they point reseachers to the age structure of cases as causing differences; what causes the age structure to differ is another question not answered by our approach.

Another caveat is that the choice of age groups will somewhat affect results. 


# References

[1] Dowd, J., Rotondi, V., Andriano, L., Brazel, D. M., Block, P., Ding, X.,  Liu, Y., Mills, M. (20220). Demographic science aids in understanding the spread and fatality rates of COVID-19. OSF Preprint. https://osf.io/se6wy/?view_only=c2f00dfe3677493faa421fc2ea38e295

[2] Kashnitsky, I. (2020). COVID-19 in unequally ageing European regions. OSF Preprint. https://doi.org/10.31219/osf.io/abx7s.

[3] Kitagawa, E. M. (1955). Components of a difference between two rates.Journal of theAmerican Statistical Association, 50:1168‚Äì1194.

[4] Lipsitch M, Donnelly CA, Fraser C, Blake IM, Cori A, Dorigatti I, et al. (2015) Potential Biases in Estimating Absolute and Relative Case-Fatality Risks during Outbreaks. PLoS Negl Trop Dis 9(7): e0003846. https://doi.org/10.1371/journal.pntd.0003846

# Data sources

https://www.cdc.go.kr/board/board.es?mid=a30402000000&bid=0030&act=view&list_no=366578

https://www.epicentro.iss.it/coronavirus/bollettino/Bollettino%20sorveglianza%20integrata%20COVID-19_16%20marzo%202020.pdf

https://www.epicentro.iss.it/coronavirus/bollettino/Bollettino%20sorveglianza%20integrata%20COVID-19_19-marzo%202020.pdf

https://experience.arcgis.com/experience/478220a4c454480e823b17327b2bf1d4 

https://de.wikipedia.org/wiki/COVID-19-Pandemie_in_Deutschland/Todesf%C3%A4lle_mit_Einzelangaben_laut_Medien

https://www.mscbs.gob.es/profesionales/saludPublica/ccayes/alertasActual/nCov-China/documentos/Actualizacion_52_COVID-19.pdf